package fp.universidad.tipos;

import java.time.DayOfWeek;
import java.time.LocalTime;
import java.time.temporal.ChronoUnit;
import java.time.temporal.TemporalUnit;

public record Tutoria(DayOfWeek diaSemana, LocalTime horaComienzo, LocalTime horaFin) {
	
	public Tutoria {
		checkDia(diaSemana);
		checkDuracion(horaComienzo, horaFin);
	}
	
	public Integer getDuracion() {
		Long dur = horaComienzo.until(horaFin, ChronoUnit.MINUTES)
		return dur.intValue();
	}
	
	private void checkDuracion(LocalTime horaComienzo, LocalTime horaFin) {
		// TODO Auto-generated method stub
		if (horaComienzo.until(horaFin, ChronoUnit.MINUTES)<15) {
			throw new IllegalArgumentException();
		}
	}

	private void checkDia(DayOfWeek diaSemana2) {
		// TODO Auto-generated method stub
		if (diaSemana2.equals(DayOfWeek.SATURDAY) || diaSemana2.equals(DayOfWeek.SUNDAY)) {
			throw new IllegalArgumentException();
		}
	}

	public Tutoria(DayOfWeek diaSemana, LocalTime horaComienzo, Integer duracionMinutos){
		this(diaSemana,horaComienzo,horaComienzo.plusMinutes(duracionMinutos));
	}

	@Override
	public String toString() {
		return sacarLetra(diaSemana) + " " + horaComienzo + "-" + horaFin;
	}
	
	public boolean equals(Object o) {
		boolean result = false;
		if (o instanceof Tutoria) {
			Tutoria oT = (Tutoria) o;
			result = diaSemana.equals(oT.diaSemana) && horaComienzo.equals(oT.horaComienzo);
		}
		return result;
	}
	
	public int hashCode() {
		return diaSemana.hashCode()*24 + horaComienzo.hashCode()*31;
	}
	
	private String sacarLetra(DayOfWeek dia) {
		String result = "";
		switch(dia) {
			case MONDAY:
				result = "L";
				break;
			case TUESDAY:
				result = "M";
				break;
			case WEDNESDAY:
				result = "X";
				break;
			case THURSDAY:
				result = "J";
				break;
			case FRIDAY:
				result = "V";
				break;
			default:
				result = "Â¿?";
				break;
		}
		return result;
	}
	
}
